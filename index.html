<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSINT Dorking Platform - Vulnerability & Misconfiguration Discovery</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Fira+Code:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #007bff; /* Deep Blue for enterprise feel */
            --secondary-color: #2c3e50; /* Darker gray */
            --accent-color: #dc3545; /* Red for warnings/critical */
            --success-color: #28a745;
            --info-color: #17a2b8;
            --warning-color: #ffc107; /* New for warnings */
            --text-color: #343a40;
            --light-text-color: #f8f9fa;
            --bg-gradient-start: #e0f2f7; /* Lighter, professional gradient */
            --bg-gradient-end: #cce7ee;
            --card-bg: rgba(255, 255, 255, 0.98); /* Near opaque white */
            --sidebar-bg-start: #343a40; /* Darker sidebar */
            --sidebar-bg-end: #495057;
            --border-color: #e9ecef;
            --shadow-light: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-medium: 0 8px 20px rgba(0, 0, 0, 0.15);
            --shadow-deep: 0 16px 40px rgba(0, 0, 0, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            color: var(--text-color);
            line-height: 1.6;
        }

        .header-top {
            width: 100%;
            max-width: 1300px; /* Wider for enterprise view */
            background: var(--secondary-color);
            color: var(--light-text-color);
            padding: 20px 40px;
            border-radius: 15px 15px 0 0;
            box-shadow: var(--shadow-deep);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            border-bottom: 3px solid var(--primary-color);
        }

        .header-top h1 {
            font-size: 2.5em;
            color: var(--light-text-color);
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.4);
            margin-bottom: 5px;
        }

        .header-top .tagline {
            font-size: 1.2em;
            opacity: 0.9;
            width: 100%;
        }
        
        .disclaimer-banner {
            background-color: var(--warning-color);
            color: var(--text-color);
            padding: 10px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 0.9em;
            text-align: center;
            max-width: 1300px;
            width: 100%;
            box-shadow: var(--shadow-light);
            font-weight: 600;
        }

        .container {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: var(--shadow-deep);
            width: 100%;
            max-width: 1300px; /* Wider */
            min-height: 750px; /* Increased min-height */
            display: grid;
            grid-template-columns: 320px 1fr; /* Wider sidebar */
            overflow: hidden;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .sidebar {
            background: linear-gradient(180deg, var(--sidebar-bg-start) 0%, var(--sidebar-bg-end) 100%);
            padding: 30px 20px;
            color: white;
            display: flex;
            flex-direction: column;
            gap: 10px;
            border-right: 1px solid rgba(255, 255, 255, 0.15);
        }

        .sidebar h2 {
            margin-bottom: 30px;
            font-size: 28px;
            text-align: center;
            color: var(--light-text-color);
            font-weight: 600;
            letter-spacing: 1px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .category-item {
            padding: 15px 20px;
            margin-bottom: 8px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.05em;
        }

        .category-item:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateX(8px);
            box-shadow: var(--shadow-light);
        }

        .category-item.active {
            background: var(--primary-color);
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.4);
            transform: scale(1.02);
            font-weight: 600;
        }

        .main-content {
            padding: 30px;
            overflow-y: auto;
            max-height: calc(750px - 60px); /* Adjust for padding */
            display: flex;
            flex-direction: column;
        }

        .main-content .header {
            margin-bottom: 30px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 20px;
        }

        .main-content .header h1 {
            font-size: 2.2em;
            color: var(--secondary-color);
            margin-bottom: 20px;
            font-weight: 700;
        }

        .search-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-engine-select {
            padding: 10px 15px;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            font-size: 15px;
            background: white;
            cursor: pointer;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23007bff%22%20d%3D%22M287%2C114.7L159.2%2C242.5c-4.5%2C4.5-10.6%2C6.7-16.7%2C6.7s-12.2-2.2-16.7-6.7L5.4%2C114.7C0.9%2C110.2-1.3%2C104.1%2C1.7-98.3c3.1-9.5%2C8.6-14.9%2C17.5-14.9s14.3%2C5.4%2C17.5%2C14.9L145.4%2C200.7c1.4%2C1.4%2C3.5%2C2.2%2C5.6%2C2.2c2.1%2C0%2C4.2-0.8%2C5.6-2.2l128.2-128.2c3.1-3.1%2C8.6-6.4%2C17.5-6.4s14.3%2C3.3%2C17.5%2C6.4c9.3%2C9.4%2C9.3%2C24.6%2C0%2C34.1L287%2C114.7z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 10px top 50%;
            background-size: 12px auto;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 15px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: var(--shadow-light);
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #0056b3;
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #218838;
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .btn-danger {
            background: var(--accent-color);
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }
        
        .btn-info {
            background: var(--info-color);
            color: white;
        }
        .btn-info:hover {
            background: #138496;
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .query-section {
            display: none;
            flex-grow: 1;
        }

        .query-section.active {
            display: block;
        }

        .query-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
        }

        .query-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }

        .query-title {
            font-size: 1.3em;
            font-weight: 600;
            color: var(--primary-color); /* Title color */
            margin-bottom: 8px;
        }
        
        .query-meta {
            display: flex;
            gap: 10px;
            font-size: 0.85em;
            margin-bottom: 10px;
            color: #6c757d;
            flex-wrap: wrap;
        }
        .query-meta span {
            padding: 3px 8px;
            border-radius: 5px;
            font-weight: 600;
        }
        .query-meta .risk {
            background-color: #f8f9fa;
        }
        .query-meta .risk.low { color: var(--success-color); }
        .query-meta .risk.medium { color: var(--warning-color); }
        .query-meta .risk.high { color: var(--accent-color); }
        .query-meta .risk.critical { color: var(--accent-color); background-color: rgba(220, 53, 69, 0.1); }
        .query-meta .tag {
            background-color: var(--info-color);
            color: white;
        }
        .query-meta .tag.user-added {
            background-color: #6f42c1; /* Purple for user-added */
        }
        .query-meta .tag.pre-template {
            background-color: #007bff; /* Blue for pre-template */
        }


        .query-description {
            color: var(--text-color);
            margin-bottom: 15px;
            line-height: 1.5;
            font-size: 0.95em;
        }

        .query-text {
            background: #e9ecef; /* Lighter background for code */
            padding: 15px;
            border-radius: 8px;
            font-family: 'Fira Code', monospace;
            font-size: 14px;
            color: var(--secondary-color); /* Darker code text */
            margin-bottom: 15px;
            border-left: 4px solid var(--primary-color); /* Primary color border */
            word-break: break-all;
            white-space: pre-wrap;
            overflow-x: auto;
        }

        .query-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: flex-start;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 10000;
            max-width: 350px;
            box-shadow: var(--shadow-medium);
            transform: translateX(120%);
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            animation: slideIn 0.4s forwards;
        }
        @keyframes slideIn {
            from { transform: translateX(120%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .notification.hide {
            animation: slideOut 0.4s forwards;
        }
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(120%); opacity: 0; }
        }

        .notification.success { background: var(--success-color); }
        .notification.error { background: var(--accent-color); }
        .notification.info { background: var(--info-color); }
        .notification.warning { background: var(--warning-color); color: var(--text-color); }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.visible {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 700px; /* Wider modal */
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-deep);
            transform: scale(0.9);
            transition: transform 0.3s ease-out;
        }

        .modal.visible .modal-content {
            transform: scale(1);
        }

        .modal-header {
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 15px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--secondary-color);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--secondary-color);
            font-size: 0.95em;
        }

        .form-input, .form-textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 15px;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }
        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.2);
        }

        .input-help {
            font-size: 12px;
            color: #95a5a6;
            margin-top: 5px;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 25px;
            border-top: 1px solid var(--border-color);
            padding-top: 15px;
        }

        .search-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 15px;
            margin-bottom: 20px;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.2);
        }

        .custom-query-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }

        .custom-query-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--secondary-color);
            margin-bottom: 20px;
        }

        .custom-form {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            align-items: end;
        }
        .custom-form .form-group:last-of-type {
            grid-column: span 2;
            display: flex;
            justify-content: flex-end;
            margin-bottom: 0;
        }
        
        .custom-form .form-group.full-width {
            grid-column: span 2;
        }

        #custom-query-result {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px dashed var(--border-color);
        }

        .footer {
            width: 100%;
            max-width: 1300px;
            background: var(--secondary-color);
            color: white;
            padding: 20px 30px;
            border-radius: 0 0 15px 15px;
            box-shadow: var(--shadow-deep);
            text-align: center;
            font-size: 0.9em;
            margin-top: 20px;
            border-top: 3px solid var(--primary-color);
        }

        .footer p {
            margin-bottom: 10px;
        }

        .footer a {
            color: var(--primary-color);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer a:hover {
            color: #fff;
            text-decoration: underline;
        }

        .footer .social-links a {
            margin: 0 10px;
            font-size: 1.2em;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
            border-bottom: 1px dashed #ccc; /* Underline for tooltip */
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 300px; /* Wider tooltip */
            background-color: var(--secondary-color);
            color: #fff;
            text-align: left; /* Left align text */
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -150px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85em;
            line-height: 1.4;
            box-shadow: var(--shadow-medium);
        }

        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: var(--secondary-color) transparent transparent transparent;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        .placeholder-variable {
            color: var(--accent-color); /* Red for variables */
            font-weight: 600;
        }

        /* Responsiveness */
        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 280px 1fr;
                min-height: 650px;
            }
            .header-top, .footer {
                max-width: 100%;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .header-top, .footer, .disclaimer-banner {
                padding: 15px 20px;
                border-radius: 10px;
                margin-bottom: 15px;
                margin-top: 15px;
            }
            .header-top h1 {
                font-size: 2em;
                text-align: center;
                width: 100%;
            }
            .header-top .tagline {
                text-align: center;
                width: 100%;
                font-size: 1em;
            }
            .container {
                grid-template-columns: 1fr;
                max-width: 100%;
                min-height: unset;
                border-radius: 10px;
            }
            .sidebar {
                padding: 20px;
                border-right: none;
                border-bottom: 1px solid rgba(255, 255, 255, 0.15);
            }
            .sidebar h2 {
                font-size: 22px;
                margin-bottom: 20px;
            }
            .main-content {
                padding: 20px;
                max-height: unset;
            }
            .main-content .header {
                margin-bottom: 20px;
                padding-bottom: 15px;
            }
            .main-content .header h1 {
                font-size: 1.8em;
                text-align: center;
            }
            .search-controls {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            .search-engine-select, .btn, .search-input {
                width: 100%;
                font-size: 14px;
            }
            .custom-form {
                grid-template-columns: 1fr;
            }
            .custom-form .form-group:last-of-type {
                grid-column: span 1;
            }
            .custom-form .form-group.full-width {
                grid-column: span 1;
            }
            .query-card {
                padding: 15px;
            }
            .query-title {
                font-size: 1.1em;
            }
            .query-text {
                font-size: 13px;
                padding: 10px;
            }
            .modal-content {
                padding: 20px;
                width: 95%;
            }
            .modal-title {
                font-size: 20px;
            }
            .notification {
                width: calc(100% - 40px);
                left: 20px;
                right: 20px;
                top: auto;
                bottom: 20px; /* Notifications from bottom on small screens */
                transform: translateX(0) translateY(120%);
                animation: slideInBottom 0.4s forwards;
            }
            @keyframes slideInBottom {
                from { transform: translateY(120%); opacity: 0; }
                to { transform: translateY(0); opacity: 1; }
            }
            .notification.hide {
                animation: slideOutBottom 0.4s forwards;
            }
            @keyframes slideOutBottom {
                from { transform: translateY(0); opacity: 1; }
                to { transform: translateY(120%); opacity: 0; }
            }
        }

        @media (max-width: 480px) {
            .header-top h1 {
                font-size: 1.5em;
            }
            .header-top .tagline {
                font-size: 0.9em;
            }
            .category-item {
                font-size: 0.95em;
                padding: 12px 15px;
            }
            .btn {
                padding: 8px 15px;
                font-size: 13px;
            }
            .query-title {
                font-size: 1em;
            }
            .query-description, .input-help {
                font-size: 0.85em;
            }
        }
    </style>
</head>
<body>
    <header class="header-top">
        <h1>🛡️ OSINT Dorking Platform</h1>
        <p class="tagline">Empowering Cybersecurity Professionals to Discover Vulnerabilities & Misconfigurations</p>
    </header>

    <div class="disclaimer-banner">
        ⚠️ **Disclaimer**: This tool facilitates discovery of publicly indexed information. Always ensure you have explicit authorization before conducting any security assessment activities on systems you do not own or manage. Ethical hacking principles and local laws must always be strictly adhered to.
    </div>

    <div class="container">
        <aside class="sidebar">
            <h2>Categories</h2>
            <div class="category-item active" data-category="enterprise_vuln">
                🏢 Vulnerabilities
            </div>
            <div class="category-item" data-category="cloud_misconfig">
                ☁️ Cloud Misconfigurations
            </div>
            <div class="category-item" data-category="code_leakage">
                💻 Code & Repo Leakage
            </div>
            <div class="category-item" data-category="api_exposure">
                🔗 API & Endpoint Exposure
            </div>
            <div class="category-item" data-category="sensitive_files">
                📄 Sensitive File Discovery
            </div>
            <div class="category-item" data-category="iot_ics">
                ⚙️ IoT & ICS Exposure
            </div>
            <div class="category-item" data-category="dev_ops_tools">
                🛠️ DevOps & Admin Panels
            </div>
            <div class="category-item" data-category="advanced_recon">
                🔎 Advanced Recon Dorks
            </div>
            <div class="category-item" data-category="custom">
                ➕ Custom Query Builder
            </div>
        </aside>

        <main class="main-content">
            <div class="header">
                <h1>Dork Query Playground</h1>
                <div class="search-controls">
                    <select class="search-engine-select" id="search-engine">
                        <option value="google">Google</option>
                        <option value="bing">Bing</option>
                        <option value="yahoo">Yahoo</option>
                        <option value="duckduckgo">DuckDuckGo</option>
                        <option value="yandex">Yandex</option>
                        <option value="shodan">Shodan (Specialized IoT/Network Search)</option>
                        <option value="censys">Censys (Specialized Host/Service Search)</option>
                    </select>
                    <button class="btn btn-info" onclick="showHistory()">📜 History</button>
                    <button class="btn btn-success" onclick="exportQueries()">💾 Export All Data</button>
                    <button class="btn btn-secondary" onclick="copyAllQueries()">📋 Copy Visible Queries</button>
                    <button class="btn btn-danger" onclick="resetAll()">🔄 Reset All Data</button>
                </div>
                <input type="text" class="search-input" placeholder="🔍 Search queries by title, description, or query text..." onkeyup="searchQueries(this.value)">
            </div>

            <section class="query-section active" data-section="custom">
                <div class="custom-query-section">
                    <div class="custom-query-title">Custom Query Builder</div>
                    <div class="custom-form">
                        <div class="form-group">
                            <label class="form-label" for="custom-operator">Search Operator</label>
                            <select class="form-input" id="custom-operator" onchange="buildCustomQuery()">
                                <option value="">(None)</option>
                                <option value="site:">site:</option>
                                <option value="inurl:">inurl:</option>
                                <option value="intitle:">intitle:</option>
                                <option value="intext:">intext:</option>
                                <option value="filetype:">filetype:</option>
                                <option value="cache:">cache:</option>
                                <option value="link:">link:</option>
                                <option value="related:">related:</option>
                                <option value="info:">info:</option>
                                <option value="define:">define:</option>
                                <option value="AROUND(X)">AROUND(X) - Proximity</option>
                                <option value="-">Exclude (-)</option>
                                <option value="OR">OR (Logical)</option>
                                <option value="AND">AND (Logical)</option>
                                <option value="inanchor:">inanchor:</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="custom-term">Base Search Term / Value</label>
                            <input type="text" class="form-input" id="custom-term" placeholder="e.g., example.com, password" onkeyup="buildCustomQuery()">
                            <div class="input-help">Primary term for the operator. For AROUND(X), use "term1 AROUND(5) term2".</div>
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label" for="custom-additional">Additional Terms / Modifiers</label>
                            <input type="text" class="form-input" id="custom-additional" placeholder="e.g., confidential, .env, inurl:admin AND login" onkeyup="buildCustomQuery()">
                            <div class="input-help">Combine with more keywords, operators, or logical connectors.</div>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-success" onclick="saveCustomQuery()">💾 Save Custom Query</button>
                        </div>
                    </div>
                    <div id="custom-query-result" style="display: none;">
                        <div class="query-meta">
                            <span class="tag user-added">Live Preview</span>
                        </div>
                        <div class="query-text" id="custom-query-display"></div>
                        <div class="query-actions">
                            <button class="btn btn-success" onclick="copyCustomQuery()">📋 Copy Live Query</button>
                            <button class="btn btn-primary" onclick="executeCustomQuery()">🚀 Execute Live Query</button>
                        </div>
                    </div>
                </div>

                <div id="saved-custom-queries" class="custom-query-section" style="display: none;">
                    <div class="custom-query-title">Saved Custom Queries</div>
                    <div id="saved-custom-queries-list">
                        </div>
                </div>
            </section>

            <section class="query-section" data-section="enterprise_vuln">
                <div class="query-card" data-query='inurl:"/jira/login.jsp" intitle:"Jira"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">Jira Login Page Exposure</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Identify publicly accessible Jira login pages. Misconfigurations can lead to unauthorized access or information disclosure.
                            <span class="tooltiptext">
                                Jira instances can contain sensitive project data, user credentials, and links to source code repositories. Public exposure combined with weak credentials or known vulnerabilities is a critical risk.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">inurl:"/jira/login.jsp" intitle:"Jira"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='intitle:"Confluence" inurl:"/login.action"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">Confluence Wiki Exposure</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Discover publicly indexed Confluence instances. These often hold vast amounts of internal company data.
                            <span class="tooltiptext">
                                Confluence wikis are repositories for internal company documentation, meeting notes, strategies, and sometimes even confidential data. Unauthorized access can lead to significant information leaks.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intitle:"Confluence" inurl:"/login.action"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='intitle:"SAP NetWeaver Application Server" inurl:"/irj/portal"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">Exposed SAP Portals</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Find publicly accessible SAP NetWeaver Application Servers, often used for enterprise resource planning (ERP).
                            <span class="tooltiptext">
                                SAP systems are central to many large enterprises, handling critical business functions. Exposure can lead to severe operational and data integrity risks.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intitle:"SAP NetWeaver Application Server" inurl:"/irj/portal"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='intitle:"Microsoft SharePoint" inurl:"_layouts/15/start.aspx"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">SharePoint Portals Exposure</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Locate publicly indexed Microsoft SharePoint portals, common for internal document management and collaboration.
                            <span class="tooltiptext">
                                SharePoint is widely used for internal collaboration and document sharing. Misconfigured instances can expose large volumes of sensitive company data.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intitle:"Microsoft SharePoint" inurl:"_layouts/15/start.aspx"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>
            </section>

            <section class="query-section" data-section="cloud_misconfig">
                <div class="query-card" data-query='site:s3.amazonaws.com inurl:"{ORGANIZATION_NAME}" -intitle:"404 Not Found" -inurl:"s3.console.aws.amazon.com"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">Specific Org S3 Bucket Exposure</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Find publicly accessible Amazon S3 buckets specifically mentioning an organization's name, excluding the AWS console itself.
                            <span class="tooltiptext">
                                S3 buckets are a common source of data leaks due to misconfigurations. Targeting by organization name increases the likelihood of finding relevant sensitive data.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">site:s3.amazonaws.com inurl:"<span class="placeholder-variable">{ORGANIZATION_NAME}</span>" -intitle:"404 Not Found" -inurl:"s3.console.aws.amazon.com"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this, 'acmecorp')">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='intext:"client_id" AND intext:"client_secret" filetype:json OR filetype:yaml OR filetype:yml' data-tag="pre-template" data-risk="high">
                    <div class="query-title">OAuth/API Keys in Config Files</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Search for exposed `client_id` and `client_secret` pairs often found in OAuth or API configuration files (JSON/YAML).
                            <span class="tooltiptext">
                                Hardcoded or exposed API keys and secrets in publicly accessible configuration files are a critical risk, allowing unauthorized access to services.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intext:"client_id" AND intext:"client_secret" filetype:json OR filetype:yaml OR filetype:yml</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='intitle:"Azure AD" inurl:"signin.microsoftonline.com" "{TENANT_NAME}"' data-tag="pre-template" data-risk="medium">
                    <div class="query-title">Azure AD Tenant Discovery</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk medium">Risk: Medium</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Identify publicly accessible Azure Active Directory login pages for specific tenants.
                            <span class="tooltiptext">
                                While not a direct vulnerability, discovering a target's Azure AD presence and tenant name can be crucial for phishing campaigns, credential stuffing, or identifying potential cloud attack surface.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intitle:"Azure AD" inurl:"signin.microsoftonline.com" "<span class="placeholder-variable">{TENANT_NAME}</span>"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this, 'microsoft.com')">✏️ Edit & Run</button>
                    </div>
                </div>
            </section>

            <section class="query-section" data-section="code_leakage">
                <div class="query-card" data-query='inurl:/.git/config -intext:"github.com" -intext:"gitlab.com" -intext:"bitbucket.org"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">Exposed Git Config Files (Detailed)</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Find exposed `.git/config` files, which can reveal repository URLs and internal paths, allowing for full repository cloning.
                            <span class="tooltiptext">
                                This is a classic misconfiguration leading to full source code disclosure. The `.git/config` file contains critical repository metadata. Excluding common Git hosting platforms helps focus on self-hosted instances.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">inurl:/.git/config -intext:"github.com" -intext:"gitlab.com" -intext:"bitbucket.org"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='inurl:/.svn/entries intitle:"Index of /"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">Exposed SVN Repositories</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Discover publicly exposed Subversion (SVN) repository entries files, indicating source code exposure.
                            <span class="tooltiptext">
                                Similar to Git, exposed SVN directories can lead to the download of the entire source code repository, potentially revealing vulnerabilities, intellectual property, or hardcoded credentials.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">inurl:/.svn/entries intitle:"Index of /"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='intext:"BEGIN RSA PRIVATE KEY" filetype:pem OR filetype:key' data-tag="pre-template" data-risk="critical">
                    <div class="query-title">Exposed Private Key Files</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk critical">Risk: Critical</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Search for publicly indexed files containing the header for RSA private keys, highly critical if exposed.
                            <span class="tooltiptext">
                                Discovery of private keys (e.g., SSH, SSL/TLS) allows an attacker to decrypt communications, impersonate servers, or gain unauthorized access to systems. This is an extremely severe vulnerability.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intext:"BEGIN RSA PRIVATE KEY" filetype:pem OR filetype:key</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>
            </section>

            <section class="query-section" data-section="api_exposure">
                <div class="query-card" data-query='inurl:"/api/v" intext:"swagger" OR intext:"openapi"' data-tag="pre-template" data-risk="medium">
                    <div class="query-title">Exposed API Documentation</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk medium">Risk: Medium</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Find publicly available API documentation (Swagger/OpenAPI UI), which can reveal sensitive endpoints and functionality.
                            <span class="tooltiptext">
                                Exposed API documentation provides a complete blueprint of an application's backend services, making it easier for attackers to find and exploit vulnerabilities.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">inurl:"/api/v" intext:"swagger" OR intext:"openapi"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='inurl:"/graphql" intitle:"GraphQL Playground" OR intitle:"GraphiQL"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">GraphQL Playground Exposure</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Discover publicly exposed GraphQL playgrounds, which allow direct interaction with GraphQL APIs and can be exploited.
                            <span class="tooltiptext">
                                GraphQL endpoints, especially with introspection enabled, can be abused to extract sensitive data, perform denial-of-service, or discover backend schema details.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">inurl:"/graphql" intitle:"GraphQL Playground" OR intitle:"GraphiQL"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='inurl:"/actuator" intext:"health" OR intext:"beans"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">Spring Boot Actuator Endpoints</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Find exposed Spring Boot Actuator endpoints, which provide operational information about a running application and can leak sensitive data.
                            <span class="tooltiptext">
                                Misconfigured Actuator endpoints can expose internal application details, environment variables, dependencies, and configuration. Certain endpoints can even allow for RCE if not properly secured.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">inurl:"/actuator" intext:"health" OR intext:"beans"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>
            </section>

            <section class="query-section" data-section="sensitive_files">
                <div class="query-card" data-query='filetype:log intext:"password" OR intext:"secret" OR intext:"api_key"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">Log Files with Credentials</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Discover publicly accessible log files containing keywords like "password", "secret", or "api_key".
                            <span class="tooltiptext">
                                Applications often log sensitive information, including credentials, to files. If these logs are web-accessible, it creates a critical data leakage point.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">filetype:log intext:"password" OR intext:"secret" OR intext:"api_key"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='filetype:bak OR filetype:old OR filetype:zip inurl:"backup" OR inurl:"temp" site:"{TARGET_DOMAIN}"' data-tag="pre-template" data-risk="medium">
                    <div class="query-title">Backup & Temporary Files on Target</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk medium">Risk: Medium</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Search for various backup and temporary file extensions within a target domain, indicating potentially overlooked sensitive data.
                            <span class="tooltiptext">
                                Developers and system administrators often leave behind backup or temporary files (e.g., .bak, .old, .zip, .tar.gz) that can contain sensitive information or older, vulnerable versions of applications.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">filetype:bak OR filetype:old OR filetype:zip inurl:"backup" OR inurl:"temp" site:"<span class="placeholder-variable">{TARGET_DOMAIN}</span>"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this, 'example.com')">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='filetype:xlsx intext:"ssn" OR intext:"credit card" OR intext:"confidential"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">Excel Spreadsheets with PII/Sensitive Data</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Discover Excel files containing sensitive keywords like "SSN", "credit card", or "confidential".
                            <span class="tooltiptext">
                                Excel spreadsheets are frequently used for data management and can inadvertently be indexed if publicly accessible, leading to severe PII or financial data breaches.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">filetype:xlsx intext:"ssn" OR intext:"credit card" OR intext:"confidential"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>
            </section>

            <section class="query-section" data-section="iot_ics">
                <div class="query-card" data-query='intitle:"Rockwell Automation" inurl:"/FactoryTalkView/"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">Rockwell FactoryTalk View Exposure</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Identify publicly accessible Rockwell FactoryTalk View instances, used in industrial automation.
                            <span class="tooltiptext">
                                Exposure of Industrial Control Systems (ICS) components like FactoryTalk View is extremely dangerous, as it can grant remote control over industrial processes, leading to significant real-world consequences.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intitle:"Rockwell Automation" inurl:"/FactoryTalkView/"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='intitle:"Default View" inurl:"/view/viewer_index.shtml"' data-tag="pre-template" data-risk="medium">
                    <div class="query-title">Generic IP Camera Login/View</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk medium">Risk: Medium</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            A general dork to find common login or default view pages for various IP cameras.
                            <span class="tooltiptext">
                                Many IP cameras use default login pages or common URLs for live views. This dork targets such patterns, often leading to insecurely configured surveillance systems.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intitle:"Default View" inurl:"/view/viewer_index.shtml"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='intitle:"Ignition Gateway" inurl:"/main/web/home"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">Ignition SCADA Gateway Exposure</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Discover publicly accessible Inductive Automation Ignition SCADA system gateways.
                            <span class="tooltiptext">
                                Ignition is a widely used SCADA platform. Its gateway exposure can provide access to industrial controls, dashboards, and databases, posing significant risks.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intitle:"Ignition Gateway" inurl:"/main/web/home"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>
            </section>

            <section class="query-section" data-section="dev_ops_tools">
                <div class="query-card" data-query='intitle:"Jenkins" inurl:"/manage" OR inurl:"/script"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">Jenkins Admin & Script Console Exposure</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Locate Jenkins CI/CD servers and their sensitive 'manage' or 'script' consoles, which allow RCE.
                            <span class="tooltiptext">
                                Exposed Jenkins instances, particularly the management or script console, are a direct path to remote code execution and compromise of development and deployment infrastructure.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intitle:"Jenkins" inurl:"/manage" OR inurl:"/script"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='intitle:"Kibana" "Elastic" inurl:"/app/kibana"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">Kibana Dashboard Exposure</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Find publicly exposed Kibana dashboards, which provide visualization and analysis of logs and metrics.
                            <span class="tooltiptext">
                                Kibana often visualizes sensitive internal data from Elasticsearch, including application logs, user activity, and system metrics. Unauthorized access can lead to significant information disclosure.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intitle:"Kibana" "Elastic" inurl:"/app/kibana"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='intitle:"Grafana" inurl:"/d/home"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">Grafana Dashboard Exposure</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Discover publicly accessible Grafana dashboards, used for monitoring and data visualization.
                            <span class="tooltiptext">
                                Grafana dashboards often expose critical infrastructure metrics, performance data, and other insights that can be leveraged by attackers for reconnaissance or identifying attack vectors.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intitle:"Grafana" inurl:"/d/home"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='intitle:"Portainer" inurl:"/#/home"' data-tag="pre-template" data-risk="high">
                    <div class="query-title">Portainer Container Management Exposure</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk high">Risk: High</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Find publicly exposed Portainer instances, a popular container management UI for Docker and Kubernetes.
                            <span class="tooltiptext">
                                Portainer provides a powerful interface to manage containerized environments. Unauthorized access can lead to arbitrary code execution, deployment of malicious containers, and complete compromise of the underlying host.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intitle:"Portainer" inurl:"/#/home"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>
            </section>

            <section class="query-section" data-section="advanced_recon">
                <div class="query-card" data-query='inurl:"/admin" site:"{TARGET_DOMAIN}" -intext:"wordpress" -intext:"joomla"' data-tag="pre-template" data-risk="medium">
                    <div class="query-title">Admin Panels on Target (Excluding CMS)</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk medium">Risk: Medium</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            A refined search for administrative panels on a specific domain, excluding common Content Management Systems (CMS) like WordPress or Joomla.
                            <span class="tooltiptext">
                                This helps focus on custom applications or less common platforms that might have more bespoke and potentially less secure admin interfaces.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">inurl:"/admin" site:"<span class="placeholder-variable">{TARGET_DOMAIN}</span>" -intext:"wordpress" -intext:"joomla"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this, 'example.com')">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='intext:"powered by" "{SOFTWARE_NAME}" -site:"{SOFTWARE_VENDOR_DOMAIN}"' data-tag="pre-template" data-risk="low">
                    <div class="query-title">Identify Specific Software Usage</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk low">Risk: Low</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Find websites explicitly stating they are "powered by" a specific software, excluding the software vendor's own domain.
                            <span class="tooltiptext">
                                Useful for identifying targets running specific software versions (e.g., "Powered by vBulletin 4.x.x") which might have known vulnerabilities. Excludes the vendor's site to find actual deployments.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intext:"powered by" "<span class="placeholder-variable">{SOFTWARE_NAME}</span>" -site:"<span class="placeholder-variable">{SOFTWARE_VENDOR_DOMAIN}</span>"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this, 'nginx, nginx.org')">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='intext:"{ERROR_MESSAGE_PATTERN}" filetype:php OR filetype:asp OR filetype:jsp' data-tag="pre-template" data-risk="medium">
                    <div class="query-title">Application-Specific Error Messages</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk medium">Risk: Medium</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Search for specific application error messages in common server-side script files, indicating potential debug mode exposure or vulnerabilities.
                            <span class="tooltiptext">
                                Generic error messages like "uncaught exception" or framework-specific errors (e.g., "laravel error") often expose sensitive internal details (stack traces, server paths, database queries) that can be exploited.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intext:"<span class="placeholder-variable">{ERROR_MESSAGE_PATTERN}</span>" filetype:php OR filetype:asp OR filetype:jsp</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this, 'uncaught exception')">✏️ Edit & Run</button>
                    </div>
                </div>

                <div class="query-card" data-query='intitle:"index of" "password.txt" OR "passwords.txt" OR "credentials.txt"' data-tag="pre-template" data-risk="critical">
                    <div class="query-title">Plaintext Password Files on Servers</div>
                    <div class="query-meta">
                        <span class="tag pre-template">Pre-template</span>
                        <span class="risk critical">Risk: Critical</span>
                    </div>
                    <div class="query-description">
                        <div class="tooltip">
                            Search for plaintext files commonly named "password.txt" or "credentials.txt" within exposed directory listings.
                            <span class="tooltiptext">
                                Developers and system administrators sometimes store credentials in plain text files. If these files are indexed by search engines, it's a direct path to credential compromise.
                            </span>
                        </div>
                    </div>
                    <div class="query-text">intitle:"index of" "password.txt" OR "passwords.txt" OR "credentials.txt"</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editQuery(this)">✏️ Edit & Run</button>
                    </div>
                </div>

            </section>
        </main>
    </div>

    <footer class="footer">
        <p>
            &copy; <span id="current-year"></span> OSINT Dorking Platform. All rights reserved.
            <br>
            For Professional Cybersecurity Reconnaissance & Ethical Hacking.
        </p>
        <div class="social-links">
            <a href="https://github.com/w3bcooki3 target="_blank" rel="noopener noreferrer" title="GitHub Repository">🐙 GitHub</a> |
            <a href="#" onclick="showNotification('Consult your organization\'s legal and compliance team for policy details.', 'info'); return false;" title="Legal & Compliance">⚖️ Legal & Compliance</a> |
            <a href="#" onclick="showNotification('Feature requests and bug reports are welcome!', 'info'); return false;" title="Support & Feedback">💬 Support</a>
        </div>
    </footer>

    <div class="modal" id="edit-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Edit Query</div>
            </div>
            <div class="form-group">
                <label class="form-label" for="edit-query-input">Query Text</label>
                <input type="text" class="form-input" id="edit-query-input" onkeyup="updateLiveEditedQuery()">
                <div class="input-help">Modify the search query as needed.</div>
            </div>
            <div class="form-group">
                <label class="form-label" for="edit-target-input">Target/Placeholder Value (Optional)</label>
                <input type="text" class="form-input" id="edit-target-input" placeholder="e.g., example.com, AcmeCorp, jira-plugin" onkeyup="updateLiveEditedQuery()">
                <div class="input-help">This value will replace ALL <span class="placeholder-variable">{VARIABLES}</span> in the query.</div>
            </div>
            <div class="form-group">
                <label class="form-label">Live Preview</label>
                <div class="query-text" id="edit-live-preview"></div>
                <div class="input-help">This is the query that will be executed.</div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                <button class="btn btn-primary" onclick="executeEditedQuery()">🚀 Execute Previewed Query</button>
            </div>
        </div>
    </div>

    <div class="modal" id="history-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Search History</div>
            </div>
            <div id="history-content">
                <p>No search history available</p>
            </div>
            <div class="modal-actions">
                <button class="btn btn-danger" onclick="clearHistory()">Clear History</button>
                <button class="btn btn-secondary" onclick="closeModal()">Close</button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let searchHistory = JSON.parse(localStorage.getItem('dorkingHistory') || '[]');
        let savedCustomQueries = JSON.parse(localStorage.getItem('savedCustomQueries') || '[]');
        let currentEditOriginalQuery = null; // Stores the original query text from the card (with placeholders)
        let currentEditTag = null; // Stores the tag (pre-template, user-added) of the query being edited


        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            loadSavedCustomQueries();
            switchCategory('enterprise_vuln');
            document.getElementById('current-year').textContent = new Date().getFullYear();

            // Initial highlight for predefined queries (done once on load)
            document.querySelectorAll('.query-section:not([data-section="custom"]) .query-card').forEach(card => {
                const originalQueryText = card.dataset.query;
                card.querySelector('.query-text').innerHTML = highlightPlaceholders(originalQueryText);
            });
            
            // Set up live preview for custom builder inputs
            document.getElementById('custom-operator').addEventListener('input', buildCustomQuery);
            document.getElementById('custom-term').addEventListener('input', buildCustomQuery);
            document.getElementById('custom-additional').addEventListener('input', buildCustomQuery);
        });

        // Event listeners
        function setupEventListeners() {
            document.querySelectorAll('.category-item').forEach(item => {
                item.addEventListener('click', function() {
                    switchCategory(this.dataset.category);
                });
            });

            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeModal();
                    }
                });
            });
        }

        // Category switching
        function switchCategory(category) {
            document.querySelectorAll('.category-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-category="${category}"]`).classList.add('active');

            document.querySelectorAll('.query-section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelector(`[data-section="${category}"]`).classList.add('active');

            if (category === 'custom' && savedCustomQueries.length > 0) {
                document.getElementById('saved-custom-queries').style.display = 'block';
            } else {
                document.getElementById('saved-custom-queries').style.display = 'none';
            }
            document.querySelector('.search-input').value = '';
            searchQueries('');
            // Ensure custom builder live preview is updated on switch
            if (category === 'custom') {
                buildCustomQuery(); // Trigger a build on category switch to show result if inputs exist
            }
        }

        // Copy query to clipboard (for both pre-template and saved custom queries)
        function copyQuery(element) {
            const queryText = element.closest('.query-card').dataset.query;
            const plainQueryText = queryText.replace(/<[^>]*>/g, '');
            navigator.clipboard.writeText(plainQueryText).then(() => {
                showNotification('Query copied to clipboard!', 'success');
                // Don't add to history for simple copy
            }).catch(() => {
                showNotification('Failed to copy query', 'error');
            });
        }

        // Execute pre-template query directly (without editing)
        function executeTemplateQuery(element) {
            const queryText = element.closest('.query-card').dataset.query;
            const plainQueryText = queryText.replace(/<[^>]*>/g, ''); // Ensure no HTML

            // Check if placeholders exist, if so, prompt for edit instead
            if (plainQueryText.includes('{') && plainQueryText.includes('}')) {
                 showNotification('This template query requires parameters. Please use "Edit & Run".', 'info');
                 editQuery(element); // Open edit modal if placeholders exist
                 return;
            }

            const searchEngine = document.getElementById('search-engine').value;
            const searchUrls = {
                google: `https://www.google.com/search?q=${encodeURIComponent(plainQueryText)}`,
                bing: `https://www.bing.com/search?q=${encodeURIComponent(plainQueryText)}`,
                yahoo: `https://search.yahoo.com/search?p=${encodeURIComponent(plainQueryText)}`,
                duckduckgo: `https://duckduckgo.com/?q=${encodeURIComponent(plainQueryText)}`,
                yandex: `https://yandex.com/search/?text=${encodeURIComponent(plainQueryText)}`,
                shodan: `https://www.shodan.io/search?query=${encodeURIComponent(plainQueryText)}`,
                censys: `https://search.censys.io/search?resource=hosts&q=${encodeURIComponent(plainQueryText)}`
            };

            if (searchUrls[searchEngine]) {
                window.open(searchUrls[searchEngine], '_blank');
                addToHistory(plainQueryText, 'executed', searchEngine, 'pre-template'); // Tag as pre-template
                showNotification(`Query executed on ${searchEngine.charAt(0).toUpperCase() + searchEngine.slice(1)}!`, 'success');
            } else {
                showNotification('Invalid search engine selected for this query type.', 'error');
            }
        }


        // Edit query (for pre-template or saved custom)
        function editQuery(element, placeholderExample = '') {
            currentEditOriginalQuery = element.closest('.query-card').dataset.query; // Store original query
            currentEditTag = element.closest('.query-card').dataset.tag || 'user-added'; // Store tag
            
            document.getElementById('edit-query-input').value = currentEditOriginalQuery.replace(/<[^>]*>/g, ''); // Clean for input
            document.getElementById('edit-target-input').value = placeholderExample;
            updateLiveEditedQuery(); // Initial live preview
            showModal('edit-modal');
        }

        // Live update for the edit modal's preview
        function updateLiveEditedQuery() {
            let queryInput = document.getElementById('edit-query-input').value;
            const targetValue = document.getElementById('edit-target-input').value;

            let liveQuery = queryInput;
            if (targetValue) {
                liveQuery = liveQuery.replace(/{(\w+)}/g, targetValue);
            }

            document.getElementById('edit-live-preview').textContent = liveQuery; // Display as plain text
        }

        // Execute the query from the edit modal
        function executeEditedQuery() {
            const finalQuery = document.getElementById('edit-live-preview').textContent; // Get the live preview text
            const searchEngine = document.getElementById('search-engine').value;

            const searchUrls = {
                google: `https://www.google.com/search?q=${encodeURIComponent(finalQuery)}`,
                bing: `https://www.bing.com/search?q=${encodeURIComponent(finalQuery)}`,
                yahoo: `https://search.yahoo.com/search?p=${encodeURIComponent(finalQuery)}`,
                duckduckgo: `https://duckduckgo.com/?q=${encodeURIComponent(finalQuery)}`,
                yandex: `https://yandex.com/search/?text=${encodeURIComponent(finalQuery)}`,
                shodan: `https://www.shodan.io/search?query=${encodeURIComponent(finalQuery)}`,
                censys: `https://search.censys.io/search?resource=hosts&q=${encodeURIComponent(finalQuery)}`
            };

            if (searchUrls[searchEngine]) {
                window.open(searchUrls[searchEngine], '_blank');
                // If it was a pre-template and modified, mark as 'modified-pre-template'
                const historyTag = (currentEditTag === 'pre-template' && finalQuery !== currentEditOriginalQuery.replace(/<[^>]*>/g, '')) ? 'modified-pre-template' : currentEditTag;
                addToHistory(finalQuery, 'executed', searchEngine, historyTag);
                showNotification(`Query executed on ${searchEngine.charAt(0).toUpperCase() + searchEngine.slice(1)}!`, 'success');
            } else {
                showNotification('Invalid search engine selected for this query type.', 'error');
            }
            closeModal(); // Close modal after execution
        }


        // Custom query builder (Live Preview)
        function buildCustomQuery() {
            const operator = document.getElementById('custom-operator').value;
            const term = document.getElementById('custom-term').value.trim();
            const additional = document.getElementById('custom-additional').value.trim();

            let customQuery = '';
            if (operator === 'AROUND(X)') {
                // Special handling for AROUND(X)
                if (term.includes('AROUND(') && term.includes(')')) {
                     customQuery = term; // Assume user typed full AROUND(X) in term
                } else {
                     customQuery = `${term} AROUND(X) ${additional || ''}`;
                }
            } else if (operator === '-' || operator === 'OR' || operator === 'AND') {
                customQuery = `${term} ${operator} ${additional}`;
            } else {
                customQuery = operator + term;
                if (additional) {
                    customQuery += ' ' + additional;
                }
            }
            customQuery = customQuery.replace(/\s+/g, ' ').trim();

            document.getElementById('custom-query-display').textContent = customQuery; // Display plain text
            document.getElementById('custom-query-result').dataset.query = customQuery; // Store plain text
            
            // Show result section only if there's actual content
            if (customQuery.length > 0) {
                document.getElementById('custom-query-result').style.display = 'block';
            } else {
                document.getElementById('custom-query-result').style.display = 'none';
            }
        }


        // Save custom query
        function saveCustomQuery() {
            const queryText = document.getElementById('custom-query-result').dataset.query;
            if (!queryText || queryText.length === 0) {
                showNotification('Build a query first before saving!', 'error');
                return;
            }

            const queryTitle = prompt('Enter a title for your custom query:', 'My Custom Dork');
            if (!queryTitle) {
                showNotification('Save cancelled.', 'info');
                return;
            }

            const queryDescription = prompt('Enter a brief description (optional):', '');

            const newCustomQuery = {
                title: queryTitle,
                description: queryDescription,
                query: queryText, // Store plain text
                tag: 'user-added',
                risk: 'N/A' // User-added queries don't have an inherent risk level unless specified
            };

            savedCustomQueries.unshift(newCustomQuery);
            localStorage.setItem('savedCustomQueries', JSON.stringify(savedCustomQueries));
            loadSavedCustomQueries();
            showNotification('Custom query saved!', 'success');
            // Reset custom builder fields after saving
            document.getElementById('custom-operator').value = '';
            document.getElementById('custom-term').value = '';
            document.getElementById('custom-additional').value = '';
            buildCustomQuery(); // Hide live preview
        }

        // Load and display saved custom queries
        function loadSavedCustomQueries() {
            const listContainer = document.getElementById('saved-custom-queries-list');
            if (savedCustomQueries.length === 0) {
                listContainer.innerHTML = '<p style="color: #666;">No custom queries saved yet. Use the builder above to create and save your own!</p>';
                document.getElementById('saved-custom-queries').style.display = 'none';
                return;
            }

            document.getElementById('saved-custom-queries').style.display = 'block';
            listContainer.innerHTML = savedCustomQueries.map((item, index) => `
                <div class="query-card" data-query="${item.query}" data-tag="${item.tag || 'user-added'}" data-risk="${item.risk || 'N/A'}">
                    <div class="query-title">${item.title}</div>
                    <div class="query-meta">
                        <span class="tag ${item.tag || 'user-added'}">${(item.tag || 'user-added').replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}</span>
                        ${item.risk && item.risk !== 'N/A' ? `<span class="risk ${item.risk.toLowerCase()}">Risk: ${item.risk.charAt(0).toUpperCase() + item.risk.slice(1)}</span>` : ''}
                    </div>
                    ${item.description ? `<div class="query-description">${item.description}</div>` : ''}
                    <div class="query-text">${highlightPlaceholders(item.query)}</div>
                    <div class="query-actions">
                        <button class="btn btn-success" onclick="copyQuery(this)">📋 Copy</button>
                        <button class="btn btn-primary" onclick="executeTemplateQuery(this)">🚀 Execute</button>
                        <button class="btn btn-secondary" onclick="editSavedCustomQuery(${index})">✏️ Edit</button>
                        <button class="btn btn-danger" onclick="deleteSavedCustomQuery(${index})">🗑️ Delete</button>
                    </div>
                </div>
            `).join('');
        }

        // Functions for saved custom queries
        function copySavedCustomQuery(index) {
            const queryText = savedCustomQueries[index].query;
            navigator.clipboard.writeText(queryText).then(() => {
                showNotification('Custom query copied from saved list!', 'success');
            });
        }

        function executeSavedCustomQuery(index) {
            const queryText = savedCustomQueries[index].query;
            const searchEngine = document.getElementById('search-engine').value;

            const searchUrls = {
                google: `https://www.google.com/search?q=${encodeURIComponent(queryText)}`,
                bing: `https://www.bing.com/search?q=${encodeURIComponent(queryText)}`,
                yahoo: `https://search.yahoo.com/search?p=${encodeURIComponent(queryText)}`,
                duckduckgo: `https://duckduckgo.com/?q=${encodeURIComponent(queryText)}`,
                yandex: `https://yandex.com/search/?text=${encodeURIComponent(queryText)}`,
                shodan: `https://www.shodan.io/search?query=${encodeURIComponent(queryText)}`,
                censys: `https://search.censys.io/search?resource=hosts&q=${encodeURIComponent(queryText)}`
            };

            if (searchUrls[searchEngine]) {
                window.open(searchUrls[searchEngine], '_blank');
                addToHistory(queryText, 'executed', searchEngine, savedCustomQueries[index].tag || 'user-added');
                showNotification(`Custom query executed on ${searchEngine.charAt(0).toUpperCase() + searchEngine.slice(1)}!`, 'success');
            } else {
                showNotification('Invalid search engine selected for this query type.', 'error');
            }
        }

        function editSavedCustomQuery(index) {
            const query = savedCustomQueries[index];
            const newTitle = prompt('Edit title:', query.title);
            if (newTitle === null) return;

            const newDescription = prompt('Edit description:', query.description || '');
            if (newDescription === null) return;

            const newQueryText = prompt('Edit query text:', query.query);
            if (newQueryText === null) return;

            savedCustomQueries[index].title = newTitle;
            savedCustomQueries[index].description = newDescription;
            savedCustomQueries[index].query = newQueryText;

            localStorage.setItem('savedCustomQueries', JSON.stringify(savedCustomQueries));
            loadSavedCustomQueries();
            showNotification('Custom query updated!', 'info');
        }

        function deleteSavedCustomQuery(index) {
            if (confirm('Are you sure you want to delete this custom query?')) {
                savedCustomQueries.splice(index, 1);
                localStorage.setItem('savedCustomQueries', JSON.stringify(savedCustomQueries));
                loadSavedCustomQueries();
                showNotification('Custom query deleted!', 'info');
            }
        }

        // Function to highlight placeholders in query text for display
        function highlightPlaceholders(query) {
            return query.replace(/\{(\w+)\}/g, '<span class="placeholder-variable">{$1}</span>');
        }

        // Search queries within the active category
        function searchQueries(searchTerm) {
            const activeSection = document.querySelector('.query-section.active');
            if (!activeSection) return;

            const queryCards = activeSection.querySelectorAll('.query-card');
            searchTerm = searchTerm.toLowerCase();

            queryCards.forEach(card => {
                const title = card.querySelector('.query-title').textContent.toLowerCase();
                const description = card.querySelector('.query-description') ? card.querySelector('.query-description').textContent.toLowerCase() : '';
                const query = card.dataset.query.toLowerCase();

                if (title.includes(searchTerm) || description.includes(searchTerm) || query.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });

            if (activeSection.dataset.section === 'custom') {
                const customBuilderSection = activeSection.querySelector('.custom-query-section:first-child');
                const savedQueriesSection = document.getElementById('saved-custom-queries');

                if (searchTerm === '') {
                    customBuilderSection.style.display = 'block';
                    if (savedCustomQueries.length > 0) savedQueriesSection.style.display = 'block';
                    buildCustomQuery(); // Ensure live preview is updated
                } else {
                    customBuilderSection.style.display = 'none';
                    if (savedCustomQueries.length > 0) {
                        const savedCards = savedQueriesSection.querySelectorAll('.query-card');
                        let anySavedVisible = false;
                        savedCards.forEach(card => {
                            if (card.style.display === 'block') {
                                anySavedVisible = true;
                            }
                        });
                        savedQueriesSection.style.display = anySavedVisible ? 'block' : 'none';
                    } else {
                        savedQueriesSection.style.display = 'none';
                    }
                }
            }
        }

        // History management
        function addToHistory(query, action, engine = null, tag = 'user-added') {
            const historyItem = {
                query: query,
                action: action,
                engine: engine,
                timestamp: new Date().toISOString(),
                tag: tag
            };

            searchHistory.unshift(historyItem);
            if (searchHistory.length > 200) {
                searchHistory = searchHistory.slice(0, 200);
            }

            localStorage.setItem('dorkingHistory', JSON.stringify(searchHistory));
        }

        function showHistory() {
            const historyContent = document.getElementById('history-content');

            if (searchHistory.length === 0) {
                historyContent.innerHTML = '<p style="color: #666;">No search history available yet. Start executing queries!</p>';
            } else {
                historyContent.innerHTML = searchHistory.map(item => `
                    <div class="query-card" style="margin-bottom: 10px;">
                        <div class="query-title">History Entry</div>
                        <div class="query-meta">
                            <span class="tag ${item.tag || 'user-added'}">${(item.tag || 'user-added').replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}</span>
                            <span style="font-size: 12px; color: #7f8c8d;">
                                ${item.action.charAt(0).toUpperCase() + item.action.slice(1)}
                                ${item.engine ? ` on <strong style="color: var(--primary-color);">${item.engine.charAt(0).toUpperCase() + item.engine.slice(1)}</strong>` : ''} -
                                ${new Date(item.timestamp).toLocaleString()}
                            </span>
                        </div>
                        <div class="query-text">${highlightPlaceholders(item.query)}</div>
                        <div class="query-actions" style="margin-top: 10px;">
                            <button class="btn btn-success btn-sm" onclick="copyHistoryQuery('${item.query.replace(/'/g, "\\'")}')">📋 Copy</button>
                            <button class="btn btn-primary btn-sm" onclick="executeHistoryQuery('${item.query.replace(/'/g, "\\'")}')">🚀 Execute</button>
                        </div>
                    </div>
                `).join('');
            }
            showModal('history-modal');
        }

        function copyHistoryQuery(query) {
            navigator.clipboard.writeText(query).then(() => {
                showNotification('Query copied from history!', 'success');
            });
        }

        function executeHistoryQuery(query) {
            const searchEngine = document.getElementById('search-engine').value;
            const searchUrls = {
                google: `https://www.google.com/search?q=${encodeURIComponent(query)}`,
                bing: `https://www.bing.com/search?q=${encodeURIComponent(query)}`,
                yahoo: `https://search.yahoo.com/search?p=${encodeURIComponent(query)}`,
                duckduckgo: `https://duckduckgo.com/?q=${encodeURIComponent(query)}`,
                yandex: `https://yandex.com/search/?text=${encodeURIComponent(query)}`,
                shodan: `https://www.shodan.io/search?query=${encodeURIComponent(query)}`,
                censys: `https://search.censys.io/search?resource=hosts&q=${encodeURIComponent(query)}`
            };

            if (searchUrls[searchEngine]) {
                window.open(searchUrls[searchEngine], '_blank');
                // When executing from history, the tag is already in the history item
                addToHistory(query, 'executed', searchEngine, 'history-re-run'); // New tag for re-runs
                showNotification(`Query executed on ${searchEngine.charAt(0).toUpperCase() + searchEngine.slice(1)}!`, 'success');
            } else {
                showNotification('Invalid search engine selected for this query type.', 'error');
            }
        }

        function clearHistory() {
            if (confirm('Are you sure you want to clear your entire search history? This action cannot be undone.')) {
                searchHistory = [];
                localStorage.removeItem('dorkingHistory');
                showNotification('History cleared!', 'info');
                closeModal();
            }
        }

        // Export functionality (all queries + history + saved custom queries)
        function exportQueries() {
            const allPredefinedQueries = [];
            document.querySelectorAll('.query-section:not([data-section="custom"]) .query-card').forEach(card => {
                allPredefinedQueries.push({
                    title: card.querySelector('.query-title').textContent,
                    risk: card.dataset.risk || 'N/A',
                    description: card.querySelector('.query-description').textContent,
                    query: card.dataset.query, // Export original data-query which contains placeholders
                    tag: card.dataset.tag || 'pre-template'
                });
            });

            const exportData = {
                predefinedQueries: allPredefinedQueries,
                savedCustomQueries: savedCustomQueries,
                history: searchHistory,
                exportDate: new Date().toISOString(),
                toolVersion: "Enterprise-Grade V1.1"
            };

            const blob = new Blob([JSON.stringify(exportData, null, 2)], {
                type: 'application/json'
            });

            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `enterprise-dorking-export-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showNotification('All data exported successfully!', 'success');
        }

        // Copy all visible queries in the current section
        function copyAllQueries() {
            const activeSection = document.querySelector('.query-section.active');
            if (!activeSection) {
                showNotification('No active section to copy queries from.', 'error');
                return;
            }

            let allVisibleQueries = [];
            activeSection.querySelectorAll('.query-card').forEach(card => {
                if (window.getComputedStyle(card).display !== 'none') {
                    allVisibleQueries.push(card.dataset.query.replace(/<[^>]*>/g, ''));
                }
            });

            if (activeSection.dataset.section === 'custom' && document.getElementById('custom-query-result').style.display !== 'none') {
                 allVisibleQueries.push(document.getElementById('custom-query-result').dataset.query);
            }

            if (allVisibleQueries.length === 0) {
                showNotification('No queries visible to copy.', 'info');
                return;
            }

            const combinedQueries = allVisibleQueries.join('\n');
            navigator.clipboard.writeText(combinedQueries).then(() => {
                showNotification(`Copied ${allVisibleQueries.length} visible queries!`, 'success');
            }).catch(() => {
                showNotification('Failed to copy queries.', 'error');
            });
        }


        // Reset functionality
        function resetAll() {
            if (confirm('Are you sure you want to reset ALL application data? This will clear history, saved custom queries, and any unsaved custom builder input.')) {
                localStorage.clear();
                searchHistory = [];
                savedCustomQueries = [];
                document.getElementById('custom-query-result').style.display = 'none';
                document.getElementById('custom-operator').value = '';
                document.getElementById('custom-term').value = '';
                document.getElementById('custom-additional').value = '';
                document.querySelector('.search-input').value = '';

                loadSavedCustomQueries();

                document.querySelectorAll('.query-card').forEach(card => {
                    card.style.display = 'block';
                    if (!card.closest('#saved-custom-queries-list') && !card.closest('#custom-query-result')) {
                        const originalQuery = card.dataset.query;
                        card.querySelector('.query-text').innerHTML = highlightPlaceholders(originalQuery);
                    }
                });

                showNotification('Application reset successfully!', 'info');
            }
        }

        // Modal functions
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('visible');
        }

        function closeModal() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.remove('visible');
            });
            currentEditOriginalQuery = null;
            currentEditTag = null;
        }

        // Notification system
        let notificationTimeout;
        function showNotification(message, type = 'info', duration = 3000) {
            clearTimeout(notificationTimeout);
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) {
                existingNotification.classList.add('hide');
                existingNotification.addEventListener('animationend', () => existingNotification.remove(), { once: true });
            }

            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;

            document.body.appendChild(notification);

            notificationTimeout = setTimeout(() => {
                notification.classList.add('hide');
                notification.addEventListener('animationend', () => notification.remove(), { once: true });
            }, duration);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key.toLowerCase()) {
                    case 's':
                        e.preventDefault();
                        exportQueries();
                        break;
                    case 'h':
                        e.preventDefault();
                        showHistory();
                        break;
                    case 'r':
                        if (e.shiftKey) {
                            e.preventDefault();
                            resetAll();
                        }
                        break;
                    case 'f':
                        e.preventDefault();
                        document.querySelector('.search-input').focus();
                        break;
                    case 'c':
                        if (!window.getSelection().toString()) {
                            e.preventDefault();
                            copyAllQueries();
                        }
                        break;
                }
            }

            if (e.key === 'Escape') {
                closeModal();
            }
        });
    </script>
</body>
</html>
